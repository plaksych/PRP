Создание собственной модели на основе вашего датасета требует нескольких шагов, включая разметку изображений, подготовку данных, обучение модели и её тестирование. Рассмотрим, как вы можете сделать это поэтапно.

### 1. Сбор данных

Сначала вам нужно собрать фотографии паспортов и, возможно, изображений без паспортов, чтобы поддерживать баланс в вашем наборе данных. Убедитесь, что у вас достаточно вариантов: разные цвета, формы, ракурсы и освещение.

### 2. Разметка изображений

Для разметки изображений вы можете использовать инструменты, такие как:

- **LabelImg**: Удобный инструмент для разметки изображений, который сохраняет аннотации в формате PASCAL VOC или YOLO.
- **CVAT**: Более сложный инструмент, который больше подходит для командной работы и больших проектов.
- **Roboflow**: Онлайн-инструмент, который также позволяет разметку и управляет процессом подготовки данных.

#### Пример разметки с помощью LabelImg:
1. Установите LabelImg:
    ```bash
    pip install labelImg
    ```
2. Запустите LabelImg:
    ```bash
    labelImg
    ```
3. Откройте изображение и нарисуйте прямоугольник вокруг паспорта. После этого выберите класс (например, "passport" или аналогичный) и сохраните аннотацию.
4. Сохраните аннотацию в формате YOLO. Каждый раз после сохранения создастся текстовый файл с тем же именем, что и изображение, который содержит координаты коробки с паспортом и его класс.

### 3. Подготовка данных

После разметки изображений вам нужно будет подготовить данные для обучения:

- Убедитесь, что у вас есть соответствующая структура каталогов. Пример:
    ```
    dataset/
        train/
            images/
                img1.jpg
                img2.jpg
                ...
            labels/
                img1.txt
                img2.txt
                ...
        val/
            images/
                img3.jpg
                ...
            labels/
                img3.txt
                ...
    ```

- Создайте файл `classes.txt`, который будет содержать названия ваших классов. Для вашего случая это может быть просто:
    ```
    passport
    ```

### 4. Обучение модели YOLO

Теперь, когда у вас есть разметка и структура данных, вы можете начать процесс обучения.

1. **Скачайте предобученные веса YOLO**. Лучше всего использовать вариант YOLOv5 или YOLOv7, так как они совместимы с PyTorch и имеют более простые возможности для обучения на собственных данных.

2. **Установите необходимые библиотеки.** Например, для использования YOLOv5:
    ```bash
    git clone https://github.com/ultralytics/yolov5.git
    cd yolov5
    pip install -r requirements.txt
    ```

3. **Настройка конфигурации.**
   Вам нужно создать файл конфигурации `.yaml` для вашей задачи. Например:
    ```yaml
    train: ../dataset/train/images
    val: ../dataset/val/images

    nc: 1  # количество классов
    names: ['passport']  # названия классов
    ```

4. **Обучение модели.**
   Используйте следующую команду для запуска процесса обучения:
   ```bash
   python train.py --img 640 --batch 16 --epochs 50 --data your_data.yaml --weights yolov5s.pt
   ```

   - `--img`: Размер изображений, на которых вы будете обучаться.
   - `--batch`: Размер пакета.
   - `--epochs`: Количество эпох обучения.
   - `--data`: Укажите путь к вашему `.yaml` файлу.
   - `--weights`: Используйте предобученные веса. Вы можете выбрать различные версии модели (например, `yolov5s.pt`, `yolov5m.pt` и т.д.).

### 5. Тестирование и оценка модели

После завершения обучения вы можете протестировать модель на новых изображениях, чтобы убедиться, что она распознает паспорта.

### 6. Использование обученной модели

Как только вы получили модель, вы можете использовать `detect.py` для распознавания объектов в новых изображениях. Например:
```bash
python detect.py --weights runs/train/exp/weights/best.pt --img 640 --conf 0.25 --source path_to_your_image.jpg
```

### Заключение

Создание собственной модели для распознавания объектов — это непростой, но выполнимый процесс. Следуйте каждой из этих стадий, и у вас будет хороший шанс обучить модель, способную идентифицировать